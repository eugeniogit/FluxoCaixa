### ADR-001: Adoção de Arquitetura Serverless para Sistema de Controle de Fluxo de Caixa

## Status

Em avaliação - Aguardando entrevista técnica com o cliente

## Contexto

O comerciante necessita de um sistema para controlar seu fluxo de caixa diário com os seguintes requisitos:

Controle de lançamentos (débitos e créditos)
Relatórios de saldo diário consolidado
Alta disponibilidade (serviço de lançamentos não pode ficar indisponível)
Capacidade de processar picos de 50 req/s com máximo 5% de perda
Solução cost-effective para pequenos e médios comerciantes

## Problema

Precisamos definir a arquitetura de software que melhor atenda aos requisitos de:

Escalabilidade: Lidar com variações de tráfego (1 req/s a 50+ req/s)
Disponibilidade: Garantir que lançamentos sempre sejam processados
Custo: Solução economicamente viável para PMEs
Manutenibilidade: Baixa complexidade operacional
Time-to-market: Desenvolvimento e deploy rápidos

## Alternativas Consideradas

### Alternativa 1: Arquitetura Tradicional (Servidor + Load Balancer)

#### Componentes:

Load Balancer
2-3 servidores
Bancos de dados
Auto Scaling

#### Prós:

Controle total sobre o ambiente
Performance previsível
Sem cold starts

#### Contras:

Custo fixo alto
Gerenciamento de patches e atualizações
Configuração complexa de auto-scaling
Ponto único de falha sem redundância adequada
Overhead operacional significativo

### Alternativa 2: Containers

#### Componentes:

Load Balancer
Cluster
Bancos de dados
Auto Scaling

#### Prós:

Escalabilidade automática
Sem gerenciamento de servidores
Isolamento de aplicações

#### Contras:

Custo médio
Cold starts em scale-up
Complexidade de configuração
Overkill para operações simples
Ainda requer gerenciamento de clusters

### Alternativa 3: Arquitetura Serverless (Escolhida)

#### Componentes:

API Gateway (Opcional)
Função Serveless
Bancos de dados
Fila

#### Prós:

Custo baseado em uso
Escalabilidade automática
Zero administração de servidores
Alta disponibilidade nativa
Integração natural entre componentes

#### Contras:

Cold starts ocasionais
Limites de timeout (15 minutos)
Vendor lock-in com AWS

## Decisão

Escolhido a Arquitetura Serverless (Alternativa 3) baseada no seguinte critério: Custo-Efetividade

### Escolha do Banco de Dados Relacional para o Serviço de Consolidado

Para o serviço de consolidado, foi escolhido um banco de dados relacional pelas seguintes vantagens:

#### Vantagens:

**Consistência de Dados**: Garantia de ACID (Atomicidade, Consistência, Isolamento, Durabilidade) para operações críticas de cálculo de saldo
**Consultas Complexas**: Suporte nativo a SQL para agregações, joins e análises financeiras complexas
**Transações**: Garantia de integridade durante operações de consolidação
**Auditoria e Compliance**: Facilidade para implementar trilhas de auditoria e controles de conformidade financeira
**Escalabilidade Vertical**: Capacidade de aumentar recursos conforme crescimento do negócio

### Estratégias de Resiliência

A arquitetura serverless escolhida incorpora as seguintes estratégias de resiliência:

#### Funções Serverless:

**Retry Automático**: Configuração de tentativas automáticas em caso de falhas temporárias
**Dead Letter Queues (DLQ)**: Redirecionamento de mensagens com falha para análise posterior
**Circuit Breaker Pattern**: Prevenção de cascata de falhas através de interrupção de chamadas com alta taxa de erro
**Timeout Configurável**: Definição de timeouts adequados para evitar execuções indefinidas
**Versionamento**: Capacidade de rollback rápido para versões anteriores em caso de problemas
**Isolamento de Recursos**: Separação de funções por responsabilidade para limitar impacto de falhas
